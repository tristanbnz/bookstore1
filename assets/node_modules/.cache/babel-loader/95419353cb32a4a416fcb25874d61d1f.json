{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\GGPC\\\\Downloads\\\\bookstore1\\\\assets\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\GGPC\\\\Downloads\\\\bookstore1\\\\assets\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:\\\\Users\\\\GGPC\\\\Downloads\\\\bookstore1\\\\assets\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\GGPC\\\\Downloads\\\\bookstore1\\\\assets\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\GGPC\\\\Downloads\\\\bookstore1\\\\assets\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\GGPC\\\\Downloads\\\\bookstore1\\\\assets\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from'react';import{API}from'aws-amplify';import{Redirect}from'react-router';import{Glyphicon}from'react-bootstrap';var AddToCart=/*#__PURE__*/function(_React$Component){_inherits(AddToCart,_React$Component);var _super=_createSuper(AddToCart);function AddToCart(props){var _this;_classCallCheck(this,AddToCart);_this=_super.call(this,props);_this.onAddToCart=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var bookInCart;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this.setState({loading:true});_context.next=3;return API.get(\"cart\",\"/cart/\".concat(_this.props.bookId),null);case 3:bookInCart=_context.sent;// if the book already exists in the cart, increase the quantity\nif(bookInCart){API.put(\"cart\",\"/cart\",{body:{bookId:_this.props.bookId,quantity:bookInCart.quantity+1}}).then(function(){return _this.setState({toCart:true});});}// if the book does not exist in the cart, add it\nelse{API.post(\"cart\",\"/cart\",{body:{bookId:_this.props.bookId,price:_this.props.price,quantity:1}}).then(function(){return _this.setState({toCart:true});});}case 5:case\"end\":return _context.stop();}}},_callee);}));_this.getVariant=function(){var style=\"btn btn-black\";return _this.props.variant&&_this.props.variant===\"center\"?style+\" btn-black-center\":style+\" pull-right\";};_this.state={loading:false,toCart:false};return _this;}_createClass(AddToCart,[{key:\"render\",value:function render(){if(this.state.toCart)return/*#__PURE__*/React.createElement(Redirect,{to:\"/cart\"});return/*#__PURE__*/React.createElement(\"button\",{className:this.getVariant(),disabled:this.state.loading,type:\"button\",onClick:this.onAddToCart},this.state.loading&&/*#__PURE__*/React.createElement(Glyphicon,{glyph:\"refresh\",className:\"spinning\"}),this.props.variant===\"buyAgain\"?\"Buy again\":\"Add to cart\");}}]);return AddToCart;}(React.Component);export default AddToCart;","map":{"version":3,"sources":["C:/Users/GGPC/Downloads/bookstore1/assets/src/common/AddToCart.tsx"],"names":["React","API","Redirect","Glyphicon","AddToCart","props","onAddToCart","setState","loading","get","bookId","bookInCart","put","body","quantity","then","toCart","post","price","getVariant","style","variant","state","Component"],"mappings":"y+BAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,GAAT,KAAoB,aAApB,CACA,OAASC,QAAT,KAAyB,cAAzB,CACA,OAASC,SAAT,KAA0B,iBAA1B,C,GAaMC,CAAAA,S,kHACJ,mBAAYC,KAAZ,CAAmC,2CACjC,uBAAMA,KAAN,EADiC,MASnCC,WATmC,sEASrB,kJACZ,MAAKC,QAAL,CAAc,CAAEC,OAAO,CAAE,IAAX,CAAd,EADY,sBAEaP,CAAAA,GAAG,CAACQ,GAAJ,CAAQ,MAAR,iBAAyB,MAAKJ,KAAL,CAAWK,MAApC,EAA8C,IAA9C,CAFb,QAENC,UAFM,eAIZ;AACA,GAAIA,UAAJ,CAAgB,CACdV,GAAG,CAACW,GAAJ,CAAQ,MAAR,CAAgB,OAAhB,CAAyB,CACvBC,IAAI,CAAE,CACJH,MAAM,CAAE,MAAKL,KAAL,CAAWK,MADf,CAEJI,QAAQ,CAAEH,UAAU,CAACG,QAAX,CAAsB,CAF5B,CADiB,CAAzB,EAKGC,IALH,CAKQ,iBAAM,OAAKR,QAAL,CAAc,CAC1BS,MAAM,CAAE,IADkB,CAAd,CAAN,EALR,EAQD,CAED;AAXA,IAYK,CACHf,GAAG,CAACgB,IAAJ,CAAS,MAAT,CAAiB,OAAjB,CAA0B,CACxBJ,IAAI,CAAE,CACJH,MAAM,CAAE,MAAKL,KAAL,CAAWK,MADf,CAEJQ,KAAK,CAAE,MAAKb,KAAL,CAAWa,KAFd,CAGJJ,QAAQ,CAAE,CAHN,CADkB,CAA1B,EAMGC,IANH,CAMQ,iBAAM,OAAKR,QAAL,CAAc,CAC1BS,MAAM,CAAE,IADkB,CAAd,CAAN,EANR,EASD,CA3BW,sDATqB,SAuCnCG,UAvCmC,CAuCtB,UAAM,CACjB,GAAIC,CAAAA,KAAK,CAAG,eAAZ,CACA,MAAO,OAAKf,KAAL,CAAWgB,OAAX,EAAsB,MAAKhB,KAAL,CAAWgB,OAAX,GAAuB,QAA7C,CAAwDD,KAAK,oBAA7D,CAAsFA,KAAK,cAAlG,CACD,CA1CkC,CAGjC,MAAKE,KAAL,CAAa,CACXd,OAAO,CAAE,KADE,CAEXQ,MAAM,CAAE,KAFG,CAAb,CAHiC,aAOlC,C,4CAqCD,iBAAS,CACP,GAAI,KAAKM,KAAL,CAAWN,MAAf,CAAuB,mBAAO,oBAAC,QAAD,EAAU,EAAE,CAAC,OAAb,EAAP,CAEvB,mBACE,8BACE,SAAS,CAAE,KAAKG,UAAL,EADb,CAEE,QAAQ,CAAE,KAAKG,KAAL,CAAWd,OAFvB,CAGE,IAAI,CAAC,QAHP,CAIE,OAAO,CAAE,KAAKF,WAJhB,EAKG,KAAKgB,KAAL,CAAWd,OAAX,eAAsB,oBAAC,SAAD,EAAW,KAAK,CAAC,SAAjB,CAA2B,SAAS,CAAC,UAArC,EALzB,CAMG,KAAKH,KAAL,CAAWgB,OAAX,GAAuB,UAAvB,0BANH,CADF,CAUD,C,uBA1DqBrB,KAAK,CAACuB,S,EA6D9B,cAAenB,CAAAA,SAAf","sourcesContent":["import React from 'react';\r\nimport { API } from 'aws-amplify';\r\nimport { Redirect } from 'react-router';\r\nimport { Glyphicon } from 'react-bootstrap';\r\n\r\ninterface AddToCartProps {\r\n  bookId: string;\r\n  price: number;\r\n  variant?: string;\r\n}\r\n\r\ninterface AddToCartState {\r\n  loading: boolean;\r\n  toCart: boolean;\r\n}\r\n\r\nclass AddToCart extends React.Component<AddToCartProps, AddToCartState> {\r\n  constructor(props: AddToCartProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      loading: false,\r\n      toCart: false\r\n    };\r\n  }\r\n\r\n  onAddToCart = async () => {\r\n    this.setState({ loading: true });\r\n    const bookInCart = await API.get(\"cart\", `/cart/${this.props.bookId}`, null);\r\n\r\n    // if the book already exists in the cart, increase the quantity\r\n    if (bookInCart) {\r\n      API.put(\"cart\", \"/cart\", {\r\n        body: {\r\n          bookId: this.props.bookId,\r\n          quantity: bookInCart.quantity + 1\r\n        }\r\n      }).then(() => this.setState({\r\n        toCart: true\r\n      }));\r\n    }\r\n\r\n    // if the book does not exist in the cart, add it\r\n    else {\r\n      API.post(\"cart\", \"/cart\", {\r\n        body: {\r\n          bookId: this.props.bookId,\r\n          price: this.props.price,\r\n          quantity: 1,\r\n        }\r\n      }).then(() => this.setState({\r\n        toCart: true\r\n      }));\r\n    }\r\n  }\r\n\r\n  getVariant = () => {\r\n    let style = \"btn btn-black\"\r\n    return this.props.variant && this.props.variant === \"center\" ? style + ` btn-black-center` : style + ` pull-right`;\r\n  }\r\n\r\n  render() {\r\n    if (this.state.toCart) return <Redirect to='/cart' />\r\n    \r\n    return (\r\n      <button \r\n        className={this.getVariant()} \r\n        disabled={this.state.loading}\r\n        type=\"button\" \r\n        onClick={this.onAddToCart}>\r\n        {this.state.loading && <Glyphicon glyph=\"refresh\" className=\"spinning\" />}\r\n        {this.props.variant === \"buyAgain\" ? `Buy again` : `Add to cart`}\r\n      </button>\r\n    );\r\n  }\r\n}\r\n\r\nexport default AddToCart;"]},"metadata":{},"sourceType":"module"}